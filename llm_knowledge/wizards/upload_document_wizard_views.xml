<?xml version="1.0" encoding="utf-8" ?>
<odoo>
    <!-- Form View for Upload Wizard -->
    <record id="view_llm_upload_document_wizard_form" model="ir.ui.view">
        <field name="name">llm.upload.document.wizard.form</field>
        <field name="model">llm.upload.document.wizard</field>
        <field name="arch" type="xml">
            <form string="Upload Documents">
                <field name="state" invisible="1" />
                <sheet>
                    <div states="confirm">
                        <div class="alert alert-info" role="alert">
                            <p><strong>Upload documents for RAG processing</strong></p>
                            <p>You can upload local files and/or provide external URLs.</p>
                        </div>
                        <group>
                            <field name="collection_id" options="{'no_create': True}" required="1"/>
                            <field name="document_name_template" placeholder="e.g. {filename}" required="1"/>
                        </group>
                        <notebook>
                            <page string="Local Files" name="local_files">
                                <field name="file_ids" widget="many2many_binary" nolabel="1" options="{'accepted_file_extensions': 'pdf,txt,html,doc,docx,odt,xls,xlsx,csv,ppt,pptx'}" />
                            </page>
                            <page string="External URLs" name="external_urls">
                                <field name="external_urls" placeholder="Enter one URL per line&#10;https://example.com/document1.pdf&#10;https://example.com/document2.html" nolabel="1"/>
                            </page>
                        </notebook>
                        <group>
                            <field name="process_immediately"/>
                        </group>
                        <div class="alert alert-info mt-3" role="alert">
                            <p><strong>Available placeholders for document name:</strong></p>
                            <ul>
                                <li><code>{filename}</code> - Name of the file or URL</li>
                                <li><code>{collection}</code> - Name of the collection</li>
                                <li><code>{index}</code> - Document index</li>
                            </ul>
                        </div>
                    </div>
                    <div states="done">
                        <div class="alert alert-success" role="alert">
                            <p><i class="fa fa-check-circle" title="Success" aria-label="Success"/> <strong>Successfully created <field name="created_count"/> RAG documents!</strong></p>
                        </div>
                        <group>
                            <field name="created_document_ids" nolabel="1" readonly="1">
                                <tree>
                                    <field name="name" />
                                    <field name="res_model" />
                                    <field name="res_id" />
                                    <field name="state" />
                                </tree>
                            </field>
                        </group>
                    </div>
                </sheet>
                <footer>
                    <button name="action_upload_documents" string="Upload Documents" type="object" class="btn-primary" attrs="{'invisible': [('state', '=', 'done')]}"/>
                    <button name="action_view_documents" string="View Documents" type="object" class="btn-primary" attrs="{'invisible': [('state', '=', 'confirm')]}"/>
                    <button special="cancel" string="Close" class="btn-secondary"/>
                </footer>
            </form>
        </field>
    </record>

    <!-- Action for Upload Document Wizard -->
    <record id="action_upload_rag_documents" model="ir.actions.act_window">
        <field name="name">Upload Documents</field>
        <field name="res_model">llm.upload.document.wizard</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
        <field name="context">{'default_document_name_template': '{filename}'}</field>
    </record>
</odoo>
